import * as yup from "yup"
import { TFunction } from "i18next"

export const createContactSchema = (t: TFunction): any => {
  const nameMinLength = 2
  const messageMinLength = 10

  return yup.object().shape({
    name: yup.string().min(nameMinLength, t(`forms.validation.min`, { length: nameMinLength })),
    email: yup.string().email(t(`forms.validation.email`)).required(t(`forms.validation.email_required`)),
    message: yup
      .string()
      .min(messageMinLength, t(`forms.validation.message_min`, { length: messageMinLength }))
      .required(t(`forms.validation.message_required`)),
  })
}

export const encodeFormData = (params: object): string => {
  return Object.keys(params)
    .map((key) => {
      return encodeURIComponent(key) + "=" + encodeURIComponent(params[key])
    })
    .join("&")
}

export const FormikStructure = {
  formId: `contact`,
  sections: [
    {
      rows: [
        {
          fields: [
            {
              id: `name`,
              name: `name`,
              type: `text`,
              component: `input`,
            },
            {
              id: `email`,
              name: `email`,
              type: `email`,
              component: `input`,
            },
          ],
        },
        {
          fields: [
            {
              id: `message`,
              name: `message`,
              component: `textarea`,
            },
          ],
        },
      ],
    },
  ],
}
